add_library(LibC
        STATIC
        stdio/rewind.cc
        stdio/parse_mode_flags.cc
        stdio/ftell.cc
        stdio/perror.cc
        stdio/popen.cc
        stdio/tmpfile.cc
        stdio/fseterr.cc
        stdio/fflush.cc
        stdio/fputs.cc
        stdio/fgetpos.cc
        stdio/printf.cc
        stdio/sprintf.cc
        stdio/ftello_unlocked.cc
        stdio/setbuf.cc
        stdio/vfprintf.cc
        stdio/fread.cc
        stdio/stdio_impl_fileno.cc
        stdio/stdio.cc
        stdio/vprintf.cc
        stdio/fopen.cc
        stdio/fprintf.cc
        stdio/fflush_write_unlocked.cc
        stdio/fgets.cc
        stdio/stdio_impl_seek.cc
        stdio/rename.cc
        stdio/freopen.cc
        stdio/stdio_impl_close.cc
        stdio/fclose.cc
        stdio/vsprintf.cc
        stdio/fdopen_static.cc
        stdio/fopen_static.cc
        stdio/getchar.cc
        stdio/fputc_unlocked.cc
        stdio/fgetc_unlocked.cc
        stdio/putchar.cc
        stdio/puts.cc
        stdio/setvbuf_unlocked.cc
        stdio/remove.cc
        stdio/fflush_write.cc
        stdio/vsnprintf.cc
        stdio/setdefbuf_unlocked.cc
        stdio/fgetc.cc
        stdio/fclose_static.cc
        stdio/ungetc.cc
        stdio/stdio_impl_read.cc
        stdio/stdio_impl_eof.cc
        stdio/pclose.cc
        stdio/stdio_impl_clearerr.cc
        stdio/fflush_unlocked.cc
        stdio/fclose_static_unlocked.cc
        stdio/putc.cc
        stdio/stdio_impl_seterr.cc
        stdio/klog.cc
        stdio/fflush_read.cc
        stdio/fileno.cc
        stdio/fread_unlocked.cc
        stdio/stdio_impl_tell.cc
        stdio/setvbuf.cc
        stdio/tmpnam.cc
        stdio/snprintf.cc
        stdio/ferror.cc
        stdio/fdopen.cc
        stdio/fungetc.cc
        stdio/readline.cc
        stdio/feof.cc
        stdio/stdio_impl_error.cc
        stdio/fputc.cc
        stdio/fflush_read_unlocked.cc
        stdio/open_file_list.cc
        stdio/vcbprintf.cc
        stdio/vfprintf_unlocked.cc
        stdio/fscanf.cc
        stdio/stdio_impl_write.cc
        stdio/sscanf.cc
        stdio/stdio_impl_reopen.cc
        stdio/clearerr.cc
        stdio/getc.cc
        stdio/kvlog.cc
        stdio/cbprintf.cc
        stdio/clearerr_unlocked.cc
        stdio/println.cc
        stdio/fwrite.cc
        stdio/fungetc_unlocked.cc
        stdio/fseek.cc
        stdio/fseeko_unlocked.cc
        stdio/fsetpos.cc
        stdio/fwrite_unlocked.cc
        libc_main.cc
        signal/raise.cc
        signal/sig_handlers.cc
        signal/signal.cc
        musl/math/lroundl.c
        musl/math/jn.c
        musl/math/floor.c
        musl/math/nexttowardf.c
        musl/math/log1p.c
        musl/math/finitef.c
        musl/math/roundl.c
        musl/math/fminf.c
        musl/math/fdim.c
        musl/math/__rem_pio2l.c
        musl/math/log1pl.c
        musl/math/hypot.c
        musl/math/roundf.c
        musl/math/tgamma.c
        musl/math/lroundf.c
        musl/math/nexttowardl.c
        musl/math/fminl.c
        musl/math/ceil.c
        musl/math/__rem_pio2f.c
        musl/math/log1pf.c
        musl/math/__tanl.c
        musl/math/fmod.c
        musl/math/scalbn.c
        musl/math/logb.c
        musl/math/asinhf.c
        musl/math/lgamma.c
        musl/math/hypotl.c
        musl/math/ldexpl.c
        musl/math/expf.c
        musl/math/frexp.c
        musl/math/cbrt.c
        musl/math/modff.c
        musl/math/acoshf.c
        musl/math/asinhl.c
        musl/math/__tan.c
        musl/math/hypotf.c
        musl/math/ldexpf.c
        musl/math/significand.c
        musl/math/expl.c
        musl/math/sqrt.c
        musl/math/__cosl.c
        musl/math/modfl.c
        musl/math/acoshl.c
        musl/math/__cos.c
        musl/math/atanh.c
        musl/math/fabs.c
        musl/math/ilogbf.c
        musl/math/fmin.c
        musl/math/fabsf.c
        musl/math/tanl.c
        musl/math/asinf.c
        musl/math/fmaxl.c
        musl/math/j0.c
        musl/math/remquof.c
        musl/math/ilogb.c
        musl/math/sinh.c
        musl/math/remquo.c
        musl/math/asin.c
        musl/math/ilogbl.c
        musl/math/scalb.c
        musl/math/__tandf.c
        musl/math/tanf.c
        musl/math/asinl.c
        musl/math/fmaxf.c
        musl/math/remquol.c
        musl/math/nearbyint.c
        musl/math/fabsl.c
        musl/math/pow.c
        musl/math/remainder.c
        musl/math/log2l.c
        musl/math/lgammaf_r.c
        musl/math/fdimf.c
        musl/math/sinhf.c
        musl/math/floorl.c
        musl/math/acosh.c
        musl/math/ldexp.c
        musl/math/coshf.c
        musl/math/signgam.c
        musl/math/cosl.c
        musl/math/exp10f.c
        musl/math/erf.c
        musl/math/expm1f.c
        musl/math/floorf.c
        musl/math/j1.c
        musl/math/rint.c
        musl/math/log10.c
        musl/math/scalbf.c
        musl/math/log2f.c
        musl/math/fdiml.c
        musl/math/sinhl.c
        musl/math/sin.c
        musl/math/cosf.c
        musl/math/exp10l.c
        musl/math/lgamma_r.c
        musl/math/__rem_pio2_large.c
        musl/math/expm1l.c
        musl/math/exp2.c
        musl/math/nexttoward.c
        musl/math/__rem_pio2.c
        musl/math/coshl.c
        musl/math/rintl.c
        musl/math/fmodf.c
        musl/math/log2.c
        musl/math/__expo2f.c
        musl/math/lgammal.c
        musl/math/__polevll.c
        musl/math/exp2l.c
        musl/math/scalblnl.c
        musl/math/truncl.c
        musl/math/acosf.c
        musl/math/__fpclassifyl.c
        musl/math/tgammal.c
        musl/math/logbl.c
        musl/math/sincosl.c
        musl/math/cosh.c
        musl/math/lgammaf.c
        musl/math/__sindf.c
        musl/math/log.c
        musl/math/rintf.c
        musl/math/fmodl.c
        musl/math/copysign.c
        musl/math/acosl.c
        musl/math/tgammaf.c
        musl/math/__fpclassifyf.c
        musl/math/modf.c
        musl/math/sincosf.c
        musl/math/logbf.c
        musl/math/__cosdf.c
        musl/math/exp10.c
        musl/math/scalblnf.c
        musl/math/exp2f.c
        musl/math/truncf.c
        musl/math/tan.c
        musl/math/ceill.c
        musl/math/scalbln.c
        musl/math/significandf.c
        musl/math/asinh.c
        musl/math/tanhf.c
        musl/math/j0f.c
        musl/math/cbrtl.c
        musl/math/lrint.c
        musl/math/sinl.c
        musl/math/atanf.c
        musl/math/log10l.c
        musl/math/tanh.c
        musl/math/__signbit.c
        musl/math/__invtrigl.c
        musl/math/tanhl.c
        musl/math/ceilf.c
        musl/math/atan.c
        musl/math/sinf.c
        musl/math/__fpclassify.c
        musl/math/atanl.c
        musl/math/log10f.c
        musl/math/j1f.c
        musl/math/round.c
        musl/math/cbrtf.c
        musl/math/sqrtl.c
        musl/math/fmaf.c
        musl/math/__signbitf.c
        musl/math/nearbyintf.c
        musl/math/__expo2.c
        musl/math/fma.c
        musl/math/trunc.c
        musl/math/logl.c
        musl/math/lrintl.c
        musl/math/atan2l.c
        musl/math/nextafterl.c
        musl/math/llroundl.c
        musl/math/erff.c
        musl/math/acos.c
        musl/math/frexpl.c
        musl/math/llrintl.c
        musl/math/nearbyintl.c
        musl/math/sqrtf.c
        musl/math/expm1.c
        musl/math/fmal.c
        musl/math/__signbitl.c
        musl/math/nextafterf.c
        musl/math/frexpf.c
        musl/math/llroundf.c
        musl/math/erfl.c
        musl/math/llrintf.c
        musl/math/__sin.c
        musl/math/logf.c
        musl/math/nan.c
        musl/math/lrintf.c
        musl/math/atan2f.c
        musl/math/nanf.c
        musl/math/scalbnl.c
        musl/math/copysignl.c
        musl/math/llrint.c
        musl/math/atanhf.c
        musl/math/sincos.c
        musl/math/powl.c
        musl/math/jnf.c
        musl/math/cos.c
        musl/math/remainderf.c
        musl/math/exp.c
        musl/math/finite.c
        musl/math/atanhl.c
        musl/math/lround.c
        musl/math/atan2.c
        musl/math/copysignf.c
        musl/math/llround.c
        musl/math/nanl.c
        musl/math/scalbnf.c
        musl/math/__sinl.c
        musl/math/nextafter.c
        musl/math/powf.c
        musl/math/fmax.c
        musl/math/remainderl.c
        musl/complex/casin.c
        musl/complex/cpow.c
        musl/complex/csinh.c
        musl/complex/cabsf.c
        musl/complex/ctanf.c
        musl/complex/cabsl.c
        musl/complex/ctanl.c
        musl/complex/ccosf.c
        musl/complex/csin.c
        musl/complex/__cexp.c
        musl/complex/cimag.c
        musl/complex/ccosl.c
        musl/complex/crealf.c
        musl/complex/casinl.c
        musl/complex/catanh.c
        musl/complex/creall.c
        musl/complex/casinf.c
        musl/complex/cexpl.c
        musl/complex/csinhl.c
        musl/complex/catanhf.c
        musl/complex/csqrt.c
        musl/complex/ccoshl.c
        musl/complex/catanhl.c
        musl/complex/csinhf.c
        musl/complex/cexpf.c
        musl/complex/cacosh.c
        musl/complex/ccoshf.c
        musl/complex/cargl.c
        musl/complex/clogf.c
        musl/complex/cacosl.c
        musl/complex/cabs.c
        musl/complex/cargf.c
        musl/complex/creal.c
        musl/complex/conj.c
        musl/complex/cacos.c
        musl/complex/clogl.c
        musl/complex/cacosf.c
        musl/complex/ctanhl.c
        musl/complex/casinhf.c
        musl/complex/cprojf.c
        musl/complex/catanl.c
        musl/complex/cacoshf.c
        musl/complex/cpowf.c
        musl/complex/ccos.c
        musl/complex/casinhl.c
        musl/complex/ctanhf.c
        musl/complex/casinh.c
        musl/complex/cexp.c
        musl/complex/cprojl.c
        musl/complex/catanf.c
        musl/complex/cacoshl.c
        musl/complex/cpowl.c
        musl/complex/ctan.c
        musl/complex/ccosh.c
        musl/complex/cimagl.c
        musl/complex/csqrtf.c
        musl/complex/clog.c
        musl/complex/cimagf.c
        musl/complex/csqrtl.c
        musl/complex/__cexpf.c
        musl/complex/cproj.c
        musl/complex/ctanh.c
        musl/complex/conjl.c
        musl/complex/carg.c
        musl/complex/csinf.c
        musl/complex/catan.c
        musl/complex/conjf.c
        musl/complex/csinl.c
        strings/strncasecmp.cc
        strings/strcasecmp.cc
        stdlib/abort.cc
        stdlib/strtod.cc
        stdlib/parse_cli_args.cc
        stdlib/atoi.cc
        stdlib/setenv.cc
        stdlib/mbstowcs.cc
        stdlib/strtoul.cc
        stdlib/strtof.cc
        stdlib/div.cc
        stdlib/bsearch.cc
        stdlib/rand.cc
        stdlib/strtol.cc
        stdlib/mktemp.cc
        stdlib/lldiv.cc
        stdlib/ldiv.cc
        stdlib/qsort.cc
        stdlib/exit.cc
        stdlib/system.cc
        stdlib/getenv.cc
        stdlib/atol.cc
        stdlib/atof.cc
        string/strxfrm.cc
        string/strcoll.cc
        string/memcpy.cc
        string/strdup.cc
        string/memset.cc
        string/strncpy.cc
        string/strcpy.cc
        string/strlen.cc
        string/strpbrk.cc
        string/strerror.cc
        string/memmove.cc
        string/memchr.cc
        string/memcmp.cc
        string/strchr.cc
        string/strcspn.cc
        string/strncmp.cc
        string/strcmp.cc
        string/strrchr.cc
        string/strncat.cc
        string/strcat.cc
        string/strstr.cc
        string/strspn.cc
        dlfcn/dlerror.cc
        unistd/write.cc
        unistd/tell.cc
        unistd/lseek.cc
        unistd/rmdir.cc
        unistd/isatty.cc
        unistd/read.cc
        unistd/getcwd.cc
        unistd/access.cc
        unistd/getopt.cc
        unistd/close.cc
        unistd/getppid.cc
        unistd/symlink.cc
        unistd/sleep.cc
        unistd/environ.cc
        unistd/fcntl.cc
        unistd/sbrk.cc
        unistd/chdir.cc
        unistd/getpid.cc
        dirent/closedir.cc
        dirent/opendir.cc
        dirent/readdir.cc
        cc_abi_support.cc
        ctype/isalpha.cc
        ctype/isxdigit.cc
        ctype/iscntrl.cc
        ctype/isupper.cc
        ctype/isgraph.cc
        ctype/toupper.cc
        ctype/isdigit.cc
        ctype/isspace.cc
        ctype/tolower.cc
        ctype/islower.cc
        ctype/isblank.cc
        ctype/ispunct.cc
        ctype/isutf8.cc
        ctype/isprint.cc
        ctype/isalnum.cc
        ctype/isascii.cc
        time/ctime.cc
        time/difftime.cc
        time/mktime.cc
        time/gmtime.cc
        time/clock.cc
        time/strptime.cc
        time/localtime.cc
        time/strftime.cc
        time/time.cc
        assert/assert_failed.cc
        errno/errno.cc
        locale/localeconv.cc
        locale/setlocale.cc
        malloc/dlmalloc.c
        fcntl/open.cc
        libgen/basename.cc
        libgen/dirname.cc
        sched/sched_yield.cc
        sys/time/gettimeofday.cc
        sys/param/getwd.cc
        sys/stat/mkdir.cc
        sys/stat/stat.cc
        sys/stat/fstat.cc
        sys/stat/umask.cc
        sys/stat/lstat.cc
        sys/stat/chmod.cc
        setjmp/i386/setjmp.s
        setjmp/i386/longjmp.s
        musl/math/i386/remquof.s
        musl/math/i386/asinf.s
        musl/math/i386/ldexpf.s
        musl/math/i386/hypotf.s
        musl/math/i386/fabsf.s
        musl/math/i386/remquol.s
        musl/math/i386/fmod.s
        musl/math/i386/ceil.s
        musl/math/i386/fabsl.s
        musl/math/i386/asinl.s
        musl/math/i386/ldexpl.s
        musl/math/i386/scalbn.s
        musl/math/i386/ldexp.s
        musl/math/i386/log1pf.s
        musl/math/i386/log2l.s
        musl/math/i386/expf.s
        musl/math/i386/log10.s
        musl/math/i386/log1pl.s
        musl/math/i386/log2f.s
        musl/math/i386/sqrt.s
        musl/math/i386/expl.s
        musl/math/i386/exp.s
        musl/math/i386/log.s
        musl/math/i386/log1p.s
        musl/math/i386/expm1l.s
        musl/math/i386/floor.s
        musl/math/i386/fabs.s
        musl/math/i386/floorf.s
        musl/math/i386/expm1f.s
        musl/math/i386/hypot.s
        musl/math/i386/floorl.s
        musl/math/i386/asin.s
        musl/math/i386/scalblnl.s
        musl/math/i386/remquo.s
        musl/math/i386/exp2.s
        musl/math/i386/scalblnf.s
        musl/math/i386/rint.s
        musl/math/i386/trunc.s
        musl/math/i386/remainderl.s
        musl/math/i386/llrintl.s
        musl/math/i386/sqrtl.s
        musl/math/i386/log10f.s
        musl/math/i386/log2.s
        musl/math/i386/sqrtf.s
        musl/math/i386/expm1.s
        musl/math/i386/llrintf.s
        musl/math/i386/log10l.s
        musl/math/i386/remainderf.s
        musl/math/i386/truncf.s
        musl/math/i386/scalbnl.s
        musl/math/i386/atan2.s
        musl/math/i386/truncl.s
        musl/math/i386/atan.s
        musl/math/i386/scalbnf.s
        musl/math/i386/acos.s
        musl/math/i386/rintl.s
        musl/math/i386/logl.s
        musl/math/i386/fmodf.s
        musl/math/i386/acosf.s
        musl/math/i386/exp2l.s
        musl/math/i386/__invtrigl.s
        musl/math/i386/rintf.s
        musl/math/i386/logf.s
        musl/math/i386/fmodl.s
        musl/math/i386/exp2f.s
        musl/math/i386/acosl.s
        musl/math/i386/llrint.s
        musl/math/i386/remainder.s
        musl/math/i386/atan2f.s
        musl/math/i386/lrintf.s
        musl/math/i386/ceill.s
        musl/math/i386/atanf.s
        musl/math/i386/lrint.s
        musl/math/i386/scalbln.s
        musl/math/i386/ceilf.s
        musl/math/i386/atan2l.s
        musl/math/i386/lrintl.s
        musl/math/i386/atanl.s
        dlfcn/dlopen.cc
        dlfcn/dlsym.cc
        dlfcn/dlclose.cc
        pthread/pthread_create.cc
        pthread/pthread_attr_init.cc
        pthread/pthread_attr_destroy.cc
        pthread/pthread_set_detachstate.cc
        pthread/pthread_join.cc
        pthread/pthread_self.cc
        pthread/pthread_kill.cc
        pthread/pthread_exit.cc)

set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wno-narrowing")

if (NOT EXISTS ${TOOLCHAIN_ROOT}/${TOOLCHAIN_TRIPLET}/lib/libstdc++.a)
    target_compile_definitions(LibC PRIVATE LIBC_BUILDING_LIBSTDCXX=1)
endif()

target_include_directories(LibC PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/musl)
add_custom_command(
        TARGET LibC
        COMMAND ${CMAKE_COMMAND} -E copy $<TARGET_FILE:LibC> ${TOOLCHAIN_ROOT}/lib/libc.a
        COMMAND ${CMAKE_AR} cr ${TOOLCHAIN_ROOT}/lib/libm.a
)
